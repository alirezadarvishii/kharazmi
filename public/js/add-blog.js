(()=>{function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t,n=document.querySelector("meta[name=csrf-token]").getAttribute("content"),r=document.querySelector("form"),o=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.loader=e}var r,o;return r=t,(o=[{key:"upload",value:function(){var e=this;return this.loader.file.then((function(t){return new Promise((function(n,r){e._initRequest(),e._initListeners(n,r,t),e._sendRequest(t)}))}))}},{key:"abort",value:function(){this.xhr&&this.xhr.abort()}},{key:"_initRequest",value:function(){var e=this.xhr=new XMLHttpRequest;e.open("POST","http://localhost:3000/blog/image/upload",!0),e.setRequestHeader("CSRF-Token",n),e.responseType="json"}},{key:"_initListeners",value:function(e,t,n){var r=this.xhr,o=this.loader,a="Couldn't upload file: ".concat(n.name,".");r.addEventListener("error",(function(){return t(a)})),r.addEventListener("abort",(function(){return t()})),r.addEventListener("load",(function(){var n=r.response;if(!n||n.error)return t(n&&n.error?n.error.message:a);e({default:n.url})})),r.upload&&r.upload.addEventListener("progress",(function(e){e.lengthComputable&&(o.uploadTotal=e.total,o.uploaded=e.loaded)}))}},{key:"_sendRequest",value:function(e){var t=new FormData;t.append("blogImg",e),this.xhr.send(t)}}])&&e(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),t}();ClassicEditor.create(document.querySelector("#ckeditor"),{language:"fa",heading:{options:[{model:"paragraph",title:"پاراگراف",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"تیتر نویس 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"تیتر نویس 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"تیتر نویس 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"تیتر نویس 4",class:"ck-heading_heading3"},{model:"heading5",view:"h5",title:"تیتر نویس 5",class:"ck-heading_heading3"},{model:"heading6",view:"h6",title:"تیتر نویس 6",class:"ck-heading_heading3"}]},extraPlugins:[function(e){e.plugins.get("FileRepository").createUploadAdapter=function(e){return new o(e)}}],toolbar:{items:["heading","|","bold","italic","link","|","fontSize","fontColor","|","imageUpload","blockQuote","insertTable","undo","redo","codeBlock"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]},simpleUpload:{uploadUrl:"/blog/blogImg",headers:{"CSRF-Token":n}}}).then((function(e){t=e})).catch((function(e){console.error(e)})),r.addEventListener("submit",(function(e){var n=document.querySelector("form [name=title]"),r=document.querySelector("form [name=category]"),o=document.querySelector("form [name=blogImg]"),a=document.querySelector("form [name=tags]"),i=document.querySelector("form [name=description]"),l=t.data.get(),s=(new FastestValidator).compile({title:{type:"string",empty:!1,messages:{stringEmpty:"تیتر پست الزامی است!"}},category:{type:"string",empty:!1,messages:{stringEmpty:"دسته بندی پست الزامی است!"}},blogImg:{type:"string",empty:!1,messages:{stringEmpty:"تصویر پست الزامی است!"}},tags:{type:"array",items:"string",unique:!0,min:2,messages:{arrayMin:"حدااقل 2 تگ الزامی است!",arrayUnique:"تگ ها باید متفاوت باشند!"}},description:{type:"string",min:20,messages:{stringMin:"دسکریپشن حدااقل 20 کاراکتر باشد!",stringMax:"دسکریپشن حدااکثر 50 کاراکتر باشد!"}},body:{type:"string",min:200,messages:{stringMin:"متن پست حدااقل 200 کاراکتر باشد!"}}})({title:n.value,category:r.value,blogImg:o.value,tags:a.value.split("/").filter((function(e){return 0!==e.length})),description:i.value,body:l});document.querySelectorAll(".invalid-feedback").forEach((function(e){return e.remove()})),document.querySelectorAll("form .form-control").forEach((function(e){return e.classList.remove("border-danger")})),console.log(s),!0!==s&&(e.preventDefault(),s.forEach((function(e){var t=document.querySelector("form [name=".concat(e.field,"]"));t.classList.add("border-danger");var n=function(e){var t=document.createElement("div");return t.classList="invalid-feedback d-block w-100 font-medium",t.textContent=e,t}(e.message);t.closest("div").appendChild(n)})))}))})();